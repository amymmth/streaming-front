{"version":3,"file":"entrypoint-helpers.js","names":["babel","_interopRequireWildcard","require","_utils","_cache","_Entrypoint","_rootLog","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","emptyHandler","undefined","getHandlers","partial","collect","jest","fn","evalFile","explodeReexports","extract","getExports","processEntrypoint","processImports","resolveImports","transform","workflow","exports","createServices","TransformCacheCollection","loadAndParseFn","ast","code","evaluator","evalConfig","log","rootLog","eventEmitter","EventEmitter","dummy","options","createEntrypoint","services","name","only","entrypoint","Entrypoint","createRoot","ignored","Error"],"sources":["../../../src/transform/__tests__/entrypoint-helpers.ts"],"sourcesContent":["import * as babel from '@babel/core';\nimport type { File } from '@babel/types';\n\nimport { EventEmitter } from '@linaria/utils';\n\nimport { TransformCacheCollection } from '../../cache';\nimport { Entrypoint } from '../Entrypoint';\nimport type { LoadAndParseFn } from '../Entrypoint.types';\nimport { rootLog } from '../rootLog';\nimport type {\n  Services,\n  Handlers,\n  ActionQueueItem,\n  SyncScenarioForAction,\n  ICollectAction,\n  IEvalAction,\n  IExplodeReexportsAction,\n  IExtractAction,\n  IGetExportsAction,\n  IProcessEntrypointAction,\n  IProcessImportsAction,\n  IResolveImportsAction,\n  ITransformAction,\n  IWorkflowAction,\n} from '../types';\n\nexport type SyncHandlers<TMode extends 'async' | 'sync'> = Handlers<TMode>;\n\n// eslint-disable-next-line require-yield\nfunction* emptyHandler<\n  TAction extends ActionQueueItem,\n>(): SyncScenarioForAction<TAction> {\n  return undefined as never;\n}\n\nexport const getHandlers = <TMode extends 'async' | 'sync'>(\n  partial: Partial<SyncHandlers<TMode>>\n) => ({\n  collect: jest.fn(emptyHandler<ICollectAction>),\n  evalFile: jest.fn(emptyHandler<IEvalAction>),\n  explodeReexports: jest.fn(emptyHandler<IExplodeReexportsAction>),\n  extract: jest.fn(emptyHandler<IExtractAction>),\n  getExports: jest.fn(emptyHandler<IGetExportsAction>),\n  processEntrypoint: jest.fn(emptyHandler<IProcessEntrypointAction>),\n  processImports: jest.fn(emptyHandler<IProcessImportsAction>),\n  resolveImports: jest.fn(emptyHandler<IResolveImportsAction>),\n  transform: jest.fn(emptyHandler<ITransformAction>),\n  workflow: jest.fn(emptyHandler<IWorkflowAction>),\n  ...partial,\n});\n\nexport const createServices: () => Services = () => ({\n  babel,\n  cache: new TransformCacheCollection(),\n  loadAndParseFn: jest.fn<ReturnType<LoadAndParseFn>, []>(() => ({\n    ast: {} as File,\n    code: '',\n    evaluator: jest.fn(),\n    evalConfig: {},\n  })),\n  log: rootLog,\n  eventEmitter: EventEmitter.dummy,\n  options: {} as Services['options'],\n});\n\nexport const createEntrypoint = (\n  services: Services,\n  name: string,\n  only: string[],\n  code?: string\n) => {\n  const entrypoint = Entrypoint.createRoot(services, name, only, code);\n\n  if (entrypoint.ignored) {\n    throw new Error('entrypoint was ignored');\n  }\n\n  return entrypoint;\n};\n"],"mappings":"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"}
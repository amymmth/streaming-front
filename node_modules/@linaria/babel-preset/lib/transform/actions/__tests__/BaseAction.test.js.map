{"version":3,"file":"BaseAction.test.js","names":["_entrypointHelpers","require","_BaseAction","describe","emptyResult","code","metadata","services","entrypoint","beforeEach","createServices","createEntrypoint","it","expect","BaseAction","toBeDefined","action","onError","undefined","jest","fn","run","generator","dummy","next","throw","imports","Map","toEqual","done","value","handler","generator1","generator2","toBe","e","error","Error","toHaveBeenCalledWith","resolved","toHaveBeenCalledTimes","toThrow","error1","error2","wait","Promise","resolve","setTimeout","gen1Next","gen1Result","fail"],"sources":["../../../../src/transform/actions/__tests__/BaseAction.test.ts"],"sourcesContent":["/* eslint-disable require-yield */\nimport type { Entrypoint } from '../../Entrypoint';\nimport {\n  createEntrypoint,\n  createServices,\n} from '../../__tests__/entrypoint-helpers';\nimport type { ITransformAction, Services, Handler } from '../../types';\nimport { BaseAction } from '../BaseAction';\n\ndescribe('BaseAction', () => {\n  const emptyResult = { code: '', metadata: null };\n\n  let services: Services;\n  let entrypoint: Entrypoint;\n\n  beforeEach(() => {\n    services = createServices();\n    entrypoint = createEntrypoint(services, '/foo/bar.js', ['default']);\n  });\n\n  it('should be defined', () => {\n    expect(BaseAction).toBeDefined();\n  });\n\n  describe('instance', () => {\n    let action: BaseAction<ITransformAction>;\n    let onError: jest.Mock;\n\n    beforeEach(() => {\n      action = new BaseAction(\n        'transform',\n        services,\n        entrypoint,\n        undefined,\n        null\n      );\n\n      onError = jest.fn();\n    });\n\n    it('action can be run', () => {\n      expect(action.run).toBeDefined();\n    });\n\n    it('run should return generator-like object', () => {\n      const generator = action.run(function* dummy() {\n        return emptyResult;\n      });\n      expect(generator.next).toBeDefined();\n      expect(generator.throw).toBeDefined();\n    });\n\n    it('generator should yield data', () => {\n      const generator = action.run<'sync', Handler<'sync', ITransformAction>>(\n        function* dummy() {\n          yield ['resolveImports', entrypoint, { imports: new Map() }, null];\n\n          return { code: 'bar', metadata: null };\n        }\n      );\n\n      expect(generator.next()).toEqual({\n        done: false,\n        value: ['resolveImports', entrypoint, { imports: new Map() }, null],\n      });\n\n      expect(generator.next()).toEqual({\n        done: true,\n        value: { code: 'bar', metadata: null },\n      });\n    });\n\n    it('should return previous result if run again', () => {\n      const handler: Handler<'sync', ITransformAction> = function* handler() {\n        yield ['resolveImports', entrypoint, { imports: new Map() }, null];\n\n        return { code: 'bar', metadata: null };\n      };\n\n      const generator1 = action.run(handler);\n      const generator2 = action.run(handler);\n\n      expect(generator1.next()).toBe(generator2.next()); // yield\n      expect(generator1.next()).toBe(generator2.next()); // return\n    });\n\n    it('should process error in generator', () => {\n      const handler: Handler<'sync', ITransformAction> = function* handler() {\n        try {\n          yield ['resolveImports', entrypoint, { imports: new Map() }, null];\n        } catch (e) {\n          onError(e);\n        }\n\n        return emptyResult;\n      };\n\n      const generator = action.run(handler);\n\n      expect(generator.next()).toEqual({\n        done: false,\n        value: ['resolveImports', entrypoint, { imports: new Map() }, null],\n      });\n\n      const error = new Error('foo');\n      expect(generator.throw(error)).toEqual({\n        done: true,\n        value: emptyResult,\n      });\n      expect(onError).toHaveBeenCalledWith(error);\n    });\n\n    it('should yield correct data after error', () => {\n      const handler: Handler<'sync', ITransformAction> = function* handler() {\n        try {\n          yield ['resolveImports', entrypoint, { imports: new Map() }, null];\n        } catch (e) {\n          onError(e);\n        }\n\n        yield ['processImports', entrypoint, { resolved: [] }, null];\n\n        return emptyResult;\n      };\n\n      const generator = action.run(handler);\n\n      expect(generator.next()).toEqual({\n        done: false,\n        value: ['resolveImports', entrypoint, { imports: new Map() }, null],\n      });\n\n      const error = new Error('foo');\n      expect(generator.throw(error)).toEqual({\n        done: false,\n        value: ['processImports', entrypoint, { resolved: [] }, null],\n      });\n      expect(onError).toHaveBeenCalledWith(error);\n\n      expect(generator.next()).toEqual({\n        done: true,\n        value: emptyResult,\n      });\n    });\n\n    it('should return the same data for repetitive runs if the first one had error', () => {\n      const handler: Handler<'sync', ITransformAction> = function* handler() {\n        try {\n          yield ['resolveImports', entrypoint, { imports: new Map() }, null];\n        } catch (e) {\n          onError(e);\n        }\n\n        return emptyResult;\n      };\n\n      const generator1 = action.run(handler);\n      const generator2 = action.run(handler);\n\n      expect(generator1.next()).toEqual({\n        done: false,\n        value: ['resolveImports', entrypoint, { imports: new Map() }, null],\n      });\n\n      const error = new Error('foo');\n      expect(generator1.throw(error)).toEqual({\n        done: true,\n        value: emptyResult,\n      });\n      expect(onError).toHaveBeenCalledWith(error);\n\n      expect(generator2.next()).toEqual({\n        done: false,\n        value: ['resolveImports', entrypoint, { imports: new Map() }, null],\n      });\n\n      expect(generator2.next()).toEqual({ done: true, value: emptyResult });\n      expect(onError).toHaveBeenCalledTimes(1);\n    });\n\n    it(\"should rethrow error from every run if the first one didn't catch it\", () => {\n      const error = new Error('foo');\n\n      const handler: Handler<'sync', ITransformAction> = function* handler() {\n        throw error;\n      };\n\n      const generator1 = action.run(handler);\n      const generator2 = action.run(handler);\n\n      expect(() => generator1.next()).toThrow(error);\n      expect(() => generator2.next()).toThrow(error);\n    });\n\n    it('should process parallel throws', () => {\n      const handler: Handler<'sync', ITransformAction> = function* handler() {\n        try {\n          yield ['resolveImports', entrypoint, { imports: new Map() }, null];\n        } catch (e) {\n          onError(e);\n        }\n\n        return emptyResult;\n      };\n\n      const generator1 = action.run(handler);\n      const generator2 = action.run(handler);\n\n      expect(generator1.next()).toEqual({\n        done: false,\n        value: ['resolveImports', entrypoint, { imports: new Map() }, null],\n      });\n      expect(generator2.next()).toEqual({\n        done: false,\n        value: ['resolveImports', entrypoint, { imports: new Map() }, null],\n      });\n\n      const error1 = new Error('foo');\n      const error2 = new Error('bar');\n      expect(generator1.throw(error1)).toEqual({\n        done: true,\n        value: emptyResult,\n      });\n      expect(generator2.throw(error2)).toEqual({\n        done: true,\n        value: emptyResult,\n      });\n      expect(onError).toHaveBeenCalledTimes(1);\n      expect(onError).toHaveBeenCalledWith(error1);\n    });\n\n    it('should cache results of async generators', async () => {\n      const wait = () =>\n        new Promise((resolve) => {\n          setTimeout(() => {\n            resolve(null);\n          }, 100);\n        });\n\n      const handler: Handler<'async', ITransformAction> =\n        async function* handler() {\n          await wait();\n          yield ['resolveImports', entrypoint, { imports: new Map() }, null];\n\n          return { code: 'bar', metadata: null };\n        };\n\n      const generator1 = action.run(handler);\n      const generator2 = action.run(handler);\n\n      const gen1Next = await generator1.next();\n      expect(gen1Next).toEqual({\n        done: false,\n        value: ['resolveImports', entrypoint, { imports: new Map() }, null],\n      });\n\n      expect(await generator2.next()).toEqual(gen1Next);\n\n      const gen1Result = await generator1.next();\n      expect(gen1Result).toEqual({\n        done: true,\n        value: { code: 'bar', metadata: null },\n      });\n\n      expect(await generator2.next()).toEqual(gen1Result);\n    });\n\n    it('should cache errors of async generators', async () => {\n      const wait = () =>\n        new Promise((resolve) => {\n          setTimeout(() => {\n            resolve(null);\n          }, 100);\n        });\n\n      const handler: Handler<'async', ITransformAction> =\n        async function* handler() {\n          await wait();\n          yield ['resolveImports', entrypoint, { imports: new Map() }, null];\n\n          throw new Error('foo');\n        };\n\n      const generator1 = action.run(handler);\n      const generator2 = action.run(handler);\n\n      const gen1Next = await generator1.next();\n      expect(gen1Next).toEqual({\n        done: false,\n        value: ['resolveImports', entrypoint, { imports: new Map() }, null],\n      });\n\n      expect(await generator2.next()).toEqual(gen1Next);\n\n      let error: unknown;\n      try {\n        await generator1.next();\n        fail('should throw');\n      } catch (e) {\n        error = e;\n        expect(e).toBe(error);\n      }\n\n      try {\n        await generator2.next();\n        fail('should throw');\n      } catch (e) {\n        expect(e).toBe(error);\n      }\n    });\n  });\n});\n"],"mappings":"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"}